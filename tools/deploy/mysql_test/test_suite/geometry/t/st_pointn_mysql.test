#owner: yky448618
#owner group: shenzhen
--echo # ----------------------------------------------------------------------
--echo # Test of GEOMETRY ST_POINTN function.
--echo # ----------------------------------------------------------------------
#--source mysql_test/test_suite/geometry/t/import_default_srs_data_mysql.inc

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,2 2)'), 1));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1e308 1e308)'), 2));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(1e308 1e308,-1e308 -1e308)'), 2));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,0 5,5 5,5 0,0 0)'), 3));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(5,5), POINT(-10,-10)))), 3));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(5,5), POINT(-5,5), POINT(0,0)))), 4));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(10,10), POINT(10,0), POINT(0,10)))), 4));

SELECT ST_ASTEXT(ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(10,10), POINT(10,0), POINT(0,10), POINT(0,0)))), 4));

# Invalid function calls of ST_POINTN

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_POINTN();

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_POINTN(NULL);

SELECT ST_POINTN(NULL, 1);

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_POINTN(ST_GEOMFROMWKB());

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(2,2)))));

--error ER_BAD_FIELD_ERROR
SELECT ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(a,1), POINT(2,2)))), 1);

--error ER_BAD_FIELD_ERROR
SELECT ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(a,1), POINT(2,b)))), 1);

--error ER_BAD_FIELD_ERROR
SELECT ST_POINTN(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(1,1), POINT(2,2)))), a);

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_POINTN(ST_GEOMFROMTEXT());

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_POINTN(ST_GEOMFROMTEXT('NULL'));

--error ER_GIS_INVALID_DATA
SELECT ST_POINTN(ST_GEOMFROMTEXT('NULL'), 1);

--error ER_GIS_INVALID_DATA
SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING()'), 2);

--error ER_GIS_INVALID_DATA
SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0)'), 3);

--error ER_GIS_INVALID_DATA
SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(1 2,1'), 4);

--error ER_GIS_INVALID_DATA
SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2,a 3)'), 5);

--error ER_PARSE_ERROR
SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING('!' 0,1 1,2 2)'), 6);

SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 2)'), 0);

SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 2)'), -1);

SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 2)'), -1024);

SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 2)'), 10000);

SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 2)'), 1234567890);

SELECT ST_POINTN(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 2)'), 'a');