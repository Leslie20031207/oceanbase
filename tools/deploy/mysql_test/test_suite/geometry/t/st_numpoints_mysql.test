#owner: yky448618
#owner group: shenzhen
--echo # ----------------------------------------------------------------------
--echo # Test of GEOMETRY ST_NUMPOINTS function.
--echo # ----------------------------------------------------------------------
#--source mysql_test/test_suite/geometry/t/import_default_srs_data_mysql.inc

SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(0 0,2 2)'));

SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(0 0,1e308 1e308)'));

SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(1e308 1e308,-1e308 -1e308)'));

SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(0 0,0 5,5 5,5 0,0 0)'));

SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(5,5), POINT(-10,-10)))));

SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(5,5), POINT(-5,5), POINT(0,0)))));

SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(10,10), POINT(10,0), POINT(0,10)))));

SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(10,10), POINT(10,0), POINT(0,10), POINT(0,0)))));

# Invalid function calls of ST_NUMPOINTS

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_NUMPOINTS();

SELECT ST_NUMPOINTS(NULL);

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_NUMPOINTS(ST_GEOMFROMWKB());

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(0,0), POINT(2,2)))), 2);

--error ER_BAD_FIELD_ERROR
SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(a,1), POINT(2,2)))));

--error ER_BAD_FIELD_ERROR
SELECT ST_NUMPOINTS(ST_GEOMFROMWKB(ST_ASWKB(LINESTRING(POINT(a,1), POINT(2,b)))));

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT());

--error ER_GIS_INVALID_DATA
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('NULL'));

--error ER_GIS_INVALID_DATA
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING()'));

--error ER_GIS_INVALID_DATA
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(0)'));

--error ER_GIS_INVALID_DATA
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(1 2,1'));

--error ER_GIS_INVALID_DATA
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING(1 1,2 2,a 3)'));

--error ER_PARSE_ERROR
SELECT ST_NUMPOINTS(ST_GEOMFROMTEXT('LINESTRING('!' 0,1 1,2 2)'));
