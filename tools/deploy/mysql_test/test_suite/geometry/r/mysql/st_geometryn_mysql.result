# ----------------------------------------------------------------------
# Test of GEOMETRY ST_GEOMETRYN function.
# ----------------------------------------------------------------------
USE test;
SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2,3 3))';
SET @gc2 = 'GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),MULTILINESTRING((25 0,0 15,15 30,0 5)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';
SET @mpt = 'MULTIPOINT(5 0,25 0,15 10,15 25)';
SET @mls = 'MULTILINESTRING((0 5,15 25,0 25),(25 0,0 15,15 30,0 5))';
SET @mpy = 'MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@gc),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@gc),2))
LINESTRING(2 2,3 3)
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@gc, 4326),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@gc, 4326),2))
LINESTRING(2 2,3 3)
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@gc2),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@gc2),2))
POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@gc2, 4326),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@gc2, 4326),2))
POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@mpt),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@mpt),2))
POINT(25 0)
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@mpt, 4326),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@mpt, 4326),2))
POINT(25 0)
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@mls),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@mls),2))
LINESTRING(25 0,0 15,15 30,0 5)
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@mls, 4326),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@mls, 4326),2))
LINESTRING(25 0,0 15,15 30,0 5)
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@mpy),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@mpy),2))
POLYGON((25 0,0 15,30 15,22 10,25 0))
SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@mpy, 4326),2));
ST_AsText(ST_GeometryN(ST_GeomFromText(@mpy, 4326),2))
POLYGON((25 0,0 15,30 15,22 10,25 0))
#====================================================================================
# ST_GEOMETRYN(geometrycollection, number)
#====================================================================================
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'), 1));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0))'), 1))
POINT(0 0)
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,2 2,4 4,6 6,8 8,10 10), POLYGON((0 0,0 5,5 5,5 0,0 0)))'), 3));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,2 2,4 4,6 6,8 8,10 10), POLYGON((0 0,0 5,5 5,5 0,0 0)))'), 3));                                   
LINESTRING(0 0,2 2,4 4,6 6,8 8,10 10)
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(0 0), MULTILINESTRING((0 0,5 5,10 10),(0 0,-5 -5,-10 -10)), MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((5 5,5 10,10 10,10 5,5 5))))'), 3));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(0 0), MULTILINESTRING((0 0,5 5,10 10),(0 0,-5 -5,-10 -10)), MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((5 5,5 10,10 10,10 5,5 5))))'), 3));
MULTIPOLYGON(((0 0,0 5,5 5,5 0,0 0)),((5 5,5 10,10 10,10 5,5 5)))
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0),GEOMETRYCOLLECTION())'), 2));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0),GEOMETRYCOLLECTION())'), 2));                    
GEOMETRYCOLLECTION EMPTY
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(10,10),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6), POINT(8,8)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4,4), POINT(4,6), POINT(6,6), POINT(6,4), POINT(4,4)))))), 2));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(10,10),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6), POINT(8,8)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POI
LINESTRING(0 0,2 2,4 4,6 6,8 8)
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
MULTIPOINT(POINT(1e308,1e308), POINT(-1e308,1e308), POINT(1e308,-1e308)),
MULTILINESTRING(LINESTRING(POINT(0,0), POINT(5,5), POINT(10,10)),
LINESTRING(POINT(0,0), POINT(-5,-5), POINT(-10,-10))),
MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0), POINT(0,1), POINT(1,1), POINT(1,0), POINT(0,0))),
POLYGON(LINESTRING(POINT(2,2), POINT(2,13), POINT(13,13), POINT(13,2), POINT(2,2)),
LINESTRING(POINT(4,4), POINT(4,6), POINT(6,6), POINT(6,4), POINT(4,4))))))), 3));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
MULTIPOINT(POINT(1e308,1e308), POINT(-1e308,1e308), POINT(1e308,-1e308)),
MULTILINESTRING(LINESTRING(POINT(0,0), POINT(5,5), POINT(10,10)),
LINESTRING(POINT(0,0), POINT(-5,-5), POINT(-
MULTIPOLYGON(((0 0,0 1,1 1,1 0,0 0)),((2 2,2 13,13 13,13 2,2 2),(4 4,4 6,6 6,6 4,4 4)))
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(0,0),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4,4), POINT(4,6), POINT(6,6), POINT(6,4), POINT(4,4))),
MULTIPOINT(POINT(1e308,1e308), POINT(-1e308,1e308), POINT(1e308,-1e308)),
MULTILINESTRING(LINESTRING(POINT(0,0), POINT(5,5), POINT(10,10)),
LINESTRING(POINT(0,0), POINT(-5,-5), POINT(-10,-10))),
MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0), POINT(0,1), POINT(1,1), POINT(1,0), POINT(0,0))),
POLYGON(LINESTRING(POINT(2,2), POINT(2,3), POINT(3,3), POINT(3,2), POINT(2,2))))))), 2));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(0,0),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4
LINESTRING(0 0,2 2,4 4,6 6)
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(0,0),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4,4), POINT(4,6), POINT(6,6), POINT(6,4), POINT(4,4))),
MULTIPOINT(POINT(1e308,1e308), POINT(-1e308,1e308), POINT(1e308,-1e308)),
MULTILINESTRING(LINESTRING(POINT(0,0), POINT(5,5), POINT(10,10)),
LINESTRING(POINT(0,0), POINT(-5,-5), POINT(-10,-10))),
MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0), POINT(0,1), POINT(1,1), POINT(1,0), POINT(0,0))),
POLYGON(LINESTRING(POINT(2,2), POINT(2,3), POINT(3,3), POINT(3,2), POINT(2,2))))))), 5));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(0,0),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4
MULTILINESTRING((0 0,5 5,10 10),(0 0,-5 -5,-10 -10))
SELECT ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(0,0),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4,4), POINT(4,6), POINT(6,6), POINT(6,4), POINT(4,4))),
MULTIPOINT(POINT(1e308,1e308), POINT(-1e308,1e308), POINT(1e308,-1e308)),
MULTILINESTRING(LINESTRING(POINT(0,0), POINT(5,5), POINT(10,10)),
LINESTRING(POINT(0,0), POINT(-5,-5), POINT(-10,-10))),
MULTIPOLYGON(POLYGON(LINESTRING(POINT(0,0), POINT(0,1), POINT(1,1), POINT(1,0), POINT(0,0))),
POLYGON(LINESTRING(POINT(2,2), POINT(2,3), POINT(3,3), POINT(3,2), POINT(2,2))))))), 6));
ST_ASTEXT(ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(
POINT(0,0),
LINESTRING(POINT(0,0), POINT(2,2), POINT(4,4), POINT(6,6)),
POLYGON(LINESTRING(POINT(0,0), POINT(10,0), POINT(10,10), POINT(0,10), POINT(0,0)),
LINESTRING(POINT(4
MULTIPOLYGON(((0 0,0 1,1 1,1 0,0 0)),((2 2,2 3,3 3,3 2,2 2)))
#====================================================================================
# Invalid function calls of ST_GeometryN
#====================================================================================
SELECT ST_GEOMETRYN();
ERROR 42000: Incorrect parameter count in the call to native function 'ST_GEOMETRYN'
SELECT ST_GEOMETRYN(NULL);
ERROR 42000: Incorrect parameter count in the call to native function 'ST_GEOMETRYN'
SELECT ST_GEOMETRYN(NULL, 1);
ST_GEOMETRYN(NULL, 1)
NULL
SELECT ST_GEOMETRYN(ST_GEOMFROMWKB());
ERROR 42000: Incorrect parameter count in the call to native function 'ST_GEOMETRYN'
SELECT ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(POINT(0,0), LINESTRING(POINT(1,1), POINT(2,2))))));
ERROR 42000: Incorrect parameter count in the call to native function 'ST_GEOMETRYN'
SELECT ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(POINT(0,0), LINESTRING(POINT(a,1), POINT(2,2))))), 1);
ERROR 42S22: Unknown column 'a' in 'field list'
SELECT ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(POINT(0,b), LINESTRING(POINT(a,1), POINT(2,2))))), 1);
ERROR 42S22: Unknown column 'b' in 'field list'
SELECT ST_GEOMETRYN(ST_GEOMFROMWKB(ST_ASWKB(GEOMETRYCOLLECTION(POINT(0,0), LINESTRING(POINT(1,1), POINT(2,2))))), A);
ERROR 42S22: Unknown column 'A' in 'field list'
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT());
ERROR 42000: Incorrect parameter count in the call to native function 'ST_GEOMETRYN'
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('NULL'), 1);
ERROR 22023: Invalid GIS data provided to function st_geomcollfromtext.
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(1)'), 2);
ERROR 22023: Invalid GIS data provided to function st_geomcollfromtext.
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0))'), 3);
ERROR 22023: Invalid GIS data provided to function st_geomcollfromtext.
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2)'), 4);
ERROR 22023: Invalid GIS data provided to function st_geomcollfromtext.
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2))'), 5);
ERROR 22023: Invalid GIS data provided to function st_geomcollfromtext.
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 a))'), 6);
ERROR 22023: Invalid GIS data provided to function st_geomcollfromtext.
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 '!'))'), 7);
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '!'))'), 7)' at line 1
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), 0);
ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), 0)
NULL
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), -1);
ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), -1)
NULL
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), -1024);
ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), -1024)
NULL
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), 10000);
ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), 10000)
NULL
SELECT ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), 123456789);
ST_GEOMETRYN(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(1 1,2 2))'), 123456789)
NULL