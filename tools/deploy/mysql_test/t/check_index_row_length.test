# owner: zhuoran.zzr
# owner group: storage
# description: previous index build do not check row length in index table, which may lead to table invalid in following operatiton

--result_format 4
connect (obsys,$OBMYSQL_MS0,root@sys,,Oceanbase,$OBMYSQL_PORT);

connection obsys;

--disable_warnings
drop table if exists t1;
--enable_warnings


# check index length, while 
create table t1(c1 int, c2 varbinary(8000), c3 int);
create index idx1 on t1(c2, c3);
--error 1118
alter table t1 modify column c3 varbinary(10000);

drop table t1;

create table t1(c1 int, c2 varchar(1000), c3 int);
create index idx1 on t1(c2, c3);
--error 1118
alter table t1 modify column c3 varchar(10000);